{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nnamdiujah/Documents/React/lesson-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/nnamdiujah/Documents/React/lesson-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/nnamdiujah/Documents/React/lesson-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/* eslint-disable react-hooks/exhaustive-deps */import React,{useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{Route,Switch,Redirect}from'react-router-dom';import{updateDirectory,updateCollection}from\"./reducers/Shop\";import Homepage from'./pages/Homepage';import Header from'./components/header/Header';import ShopPage from'./pages/Shop/ShopPage';import Checkout from'./pages/checkout/Checkout';import SignInPage from'./pages/SignIn/SignIn-and-SignOut-Page';import Collection from'./components/collection/Collection';import{auth,createUserProfileDocument}from'./firebase/firebase.utils';import'./App.css';var App=function App(){var dispatch=useDispatch();var isLoggedIn=useSelector(function(state){return state.firebase.auth;});var _useSelector=useSelector(function(state){return state.shop;}),directory=_useSelector.directory,collection=_useSelector.collection;var setUser=function setUser(user){dispatch({type:'LOAD_USER',user:user});};useEffect(function(){var unsubscribeFromAuth=auth.onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userAuth){var userRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!userAuth){_context.next=8;break;}_context.next=3;return createUserProfileDocument(userAuth);case 3:userRef=_context.sent;// checks if user exists in store and if not adds to store\nuserRef.onSnapshot(function(snapShot){setUser(_objectSpread({id:snapShot.id},snapShot.data()));});console.log(userAuth,'user');_context.next=9;break;case 8:setUser(userAuth);case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());if(directory.length<1){updateDirectory()(dispatch);}if(collection.length<1){updateCollection()(dispatch);}return function(){unsubscribeFromAuth();};},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\",render:function render(){return isLoggedIn?/*#__PURE__*/React.createElement(Homepage,null):/*#__PURE__*/React.createElement(SignInPage,null);}}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/shop\",component:ShopPage}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/checkout\",render:function render(){return isLoggedIn.uid?/*#__PURE__*/React.createElement(Checkout,null):/*#__PURE__*/React.createElement(SignInPage,null);}}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/sign-in\",render:function render(){return isLoggedIn.uid?/*#__PURE__*/React.createElement(Redirect,{to:\"/\"}):/*#__PURE__*/React.createElement(SignInPage,null);}}),/*#__PURE__*/React.createElement(Route,{path:\"/shop/:collectionid\",component:Collection})));};export default App;","map":{"version":3,"sources":["/Users/nnamdiujah/Documents/React/lesson-1/client/src/App.js"],"names":["React","useEffect","useDispatch","useSelector","Route","Switch","Redirect","updateDirectory","updateCollection","Homepage","Header","ShopPage","Checkout","SignInPage","Collection","auth","createUserProfileDocument","App","dispatch","isLoggedIn","state","firebase","shop","directory","collection","setUser","user","type","unsubscribeFromAuth","onAuthStateChanged","userAuth","userRef","onSnapshot","snapShot","id","data","console","log","length","uid"],"mappings":"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","sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport React,{useEffect} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {Route,Switch, Redirect} from 'react-router-dom';\nimport {updateDirectory,updateCollection} from \"./reducers/Shop\"\nimport Homepage from './pages/Homepage';\nimport Header from './components/header/Header';\nimport ShopPage from './pages/Shop/ShopPage';\nimport Checkout from './pages/checkout/Checkout';\nimport SignInPage from './pages/SignIn/SignIn-and-SignOut-Page';\nimport Collection from './components/collection/Collection';\nimport {auth , createUserProfileDocument} from './firebase/firebase.utils';\nimport './App.css'\n\n\nconst App = () => {\n  const dispatch = useDispatch();\n  const isLoggedIn = useSelector(state => state.firebase.auth);\n  const {directory,collection} = useSelector(state => state.shop);\n\n  const setUser = (user) => {\n    dispatch({type:'LOAD_USER', user: user})\n  }\n\n  useEffect(() => {\n    const unsubscribeFromAuth = auth.onAuthStateChanged( async userAuth => {\n      \n      if(userAuth){\n        const userRef = await createUserProfileDocument(userAuth); // checks if user exists in store and if not adds to store\n  \n        userRef.onSnapshot(snapShot => {\n          setUser({id: snapShot.id, ...snapShot.data()});\n        })\n        console.log(userAuth, 'user');\n      } else setUser(userAuth);\n  \n    }) \n    \n    if(directory.length < 1){\n      updateDirectory()(dispatch);\n    }\n\n    if(collection.length < 1){\n      updateCollection()(dispatch);\n    }\n    \n    return ()=>{\n      unsubscribeFromAuth();\n    }\n  }, [])\n  \n\n  return ( \n    <>\n      <Header/>\n            <Switch>\n                <Route exact path='/' render={() => isLoggedIn ? (<Homepage/>) : (<SignInPage/>)}/>\n                <Route exact path='/shop' component={ShopPage}/>\n                <Route exact path='/checkout' render={() => isLoggedIn.uid ? (<Checkout/>) : (<SignInPage/>)} />\n                <Route exact path ='/sign-in' render={() => isLoggedIn.uid ? (<Redirect to=\"/\"/>) : (<SignInPage/>)}/>\n                <Route path={`/shop/:collectionid`} component={Collection}/>\n            </Switch>\n    </>\n   );\n}\n \nexport default App;\n"]},"metadata":{},"sourceType":"module"}